import{p as g,k as C,r as w,j as e,C as y,m as N,n as b,s as v,o as k,B as S,L as F}from"./index-CYxau8sd.js";import{u as P,F as z,a as t,b as i,c,d as m,e as l,s as E,f as I,z as o}from"./authService-yGxDkwap.js";import{I as d}from"./label-Bp9CGYzI.js";import{C as x}from"./checkbox-Wy7-IGrN.js";import"./check-C262IvaK.js";const L=/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,20}$/,R=o.object({email:o.string().email("이메일 형식이 올바르지 않습니다."),name:o.string().min(2,"이름은 2자 이상 입력해주세요.").max(50,"이름은 50자 이하로 입력해주세요."),password:o.string().regex(L,"비밀번호는 8~20자, 영문/숫자/특수문자를 포함해야 합니다."),passwordConfirm:o.string().min(1,"비밀번호 확인을 입력해주세요."),termsService:o.boolean().refine(r=>r===!0,"서비스 이용약관 동의가 필요합니다."),privacyPolicy:o.boolean().refine(r=>r===!0,"개인정보 처리방침 동의가 필요합니다."),marketingConsent:o.boolean().optional().default(!1)}).refine(r=>r.password===r.passwordConfirm,{message:"비밀번호가 일치하지 않습니다.",path:["passwordConfirm"]});function D(){const{toast:r}=g(),h=C(),[p,j]=w.useState(!1),n=P({resolver:E(R),defaultValues:{email:"",name:"",password:"",passwordConfirm:"",termsService:!1,privacyPolicy:!1,marketingConsent:!1}}),u=async s=>{j(!0);try{await I({email:s.email,password:s.password,name:s.name,role:"SENIOR",agreements:{termsService:s.termsService,privacyPolicy:s.privacyPolicy,marketingConsent:!!s.marketingConsent}}),r({title:"회원가입 완료",description:"이제 로그인할 수 있습니다."}),h("/login",{replace:!0})}catch(a){const f=a instanceof Error?a.message:"회원가입에 실패했습니다.";r({title:"회원가입 실패",description:f,variant:"destructive"})}finally{j(!1)}};return e.jsx("main",{className:"flex min-h-screen w-full items-center justify-center bg-background p-6",children:e.jsxs(y,{className:"w-full max-w-md",children:[e.jsxs(N,{className:"text-center",children:[e.jsx(b,{className:"text-2xl font-headline",children:"회원가입"}),e.jsx(v,{children:"이메일 계정을 생성합니다."})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsx(z,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(u),className:"space-y-4",children:[e.jsx(t,{control:n.control,name:"email",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"이메일"}),e.jsx(m,{children:e.jsx(d,{placeholder:"name@example.com",autoComplete:"email",...s})}),e.jsx(l,{})]})}),e.jsx(t,{control:n.control,name:"name",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"이름"}),e.jsx(m,{children:e.jsx(d,{placeholder:"홍길동",autoComplete:"name",...s})}),e.jsx(l,{})]})}),e.jsx(t,{control:n.control,name:"password",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"비밀번호"}),e.jsx(m,{children:e.jsx(d,{type:"password",autoComplete:"new-password",...s})}),e.jsx(l,{})]})}),e.jsx(t,{control:n.control,name:"passwordConfirm",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"비밀번호 확인"}),e.jsx(m,{children:e.jsx(d,{type:"password",autoComplete:"new-password",...s})}),e.jsx(l,{})]})}),e.jsxs("div",{className:"space-y-3 rounded-md border p-3",children:[e.jsx(t,{control:n.control,name:"termsService",render:({field:s})=>e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{checked:s.value,onCheckedChange:a=>s.onChange(!!a)}),e.jsx(c,{className:"cursor-pointer",children:"서비스 이용약관 동의(필수)"})]}),e.jsx(l,{})]})}),e.jsx(t,{control:n.control,name:"privacyPolicy",render:({field:s})=>e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{checked:s.value,onCheckedChange:a=>s.onChange(!!a)}),e.jsx(c,{className:"cursor-pointer",children:"개인정보 처리방침 동의(필수)"})]}),e.jsx(l,{})]})}),e.jsx(t,{control:n.control,name:"marketingConsent",render:({field:s})=>e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{checked:s.value,onCheckedChange:a=>s.onChange(!!a)}),e.jsx(c,{className:"cursor-pointer",children:"마케팅 수신 동의(선택)"})]}),e.jsx(l,{})]})})]}),e.jsx(S,{type:"submit",className:"w-full",size:"xl",disabled:p,children:p?"가입 중...":"회원가입"})]})}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["이미 계정이 있으신가요?"," ",e.jsx(F,{className:"text-primary underline underline-offset-4",to:"/login",children:"로그인"})]})]})]})})}export{D as default};
