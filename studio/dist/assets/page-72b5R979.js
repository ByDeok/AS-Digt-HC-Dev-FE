import{c as u,r as x,l as f,p as v,j as t,C as w,n as C,o as j,s as N,k,i as b,X as P,B as p}from"./index-ClgdERjX.js";import{a as c}from"./api-DZjyy_ef.js";import{u as i}from"./common-nrhy01Dw.js";import{C as E}from"./circle-check-Cva-aAKD.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]],D=u("HeartPulse",S);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["polyline",{points:"12 10 12 12 13 13",key:"19dquz"}],["path",{d:"m16.13 7.66-.81-4.05a2 2 0 0 0-2-1.61h-2.68a2 2 0 0 0-2 1.61l-.78 4.05",key:"18k57s"}],["path",{d:"m7.88 16.36.8 4a2 2 0 0 0 2 1.61h2.72a2 2 0 0 0 2-1.61l.81-4.05",key:"16ny36"}]],A=u("Watch",T),_={listDevices:async()=>{const e=await c.get("/v1/integration/devices");return i(e,"연동된 디바이스 목록을 불러오지 못했습니다.")},connectDevice:async e=>{const n=await c.post("/v1/integration/devices",e);return i(n,"디바이스 연동에 실패했습니다.")},disconnectDevice:async e=>{await c.delete(`/v1/integration/devices/${e}`)},syncDevice:async e=>{const n=await c.post(`/v1/integration/devices/${e}/sync`);return i(n,"디바이스 동기화에 실패했습니다.")},listPortals:async()=>{const e=await c.get("/v1/integration/portals");return i(e,"연동된 포털 목록을 불러오지 못했습니다.")},connectPortal:async e=>{const n=await c.post("/v1/integration/portals",e);return i(n,"포털 연동에 실패했습니다.")},syncPortal:async e=>{const n=await c.post(`/v1/integration/portals/${e}/sync`);return i(n,"포털 동기화에 실패했습니다.")},disconnectPortal:async e=>{await c.delete(`/v1/integration/portals/${e}`)},listConsents:async()=>{const e=await c.get("/v1/integration/consents");return i(e,"동의 목록을 불러오지 못했습니다.")},revokeConsent:async(e,n)=>{await c.delete(`/v1/integration/consents/${e}`,{data:n?{revokeReason:n}:void 0})}},$=[{id:"watch",name:"스마트 워치",icon:A},{id:"bp",name:"스마트 혈압계",icon:D}];function L(){const[e,n]=x.useState({}),m=f(),{toast:l}=v(),g=async s=>{n(o=>({...o,[s]:"connecting"}));const a=s==="watch"?"WATCH":"BP_MONITOR",r=s==="watch"?["STEPS","HEART_RATE","SLEEP"]:["BLOOD_PRESSURE"];try{await _.connectDevice({vendor:"mock",deviceType:a,authCode:"local",consentScope:{dataTypes:r,frequency:"daily",retentionPeriod:"30d",sharingAllowed:{family:!0}}}),n(o=>({...o,[s]:"connected"})),l({title:"연동 완료",description:`${s==="watch"?"스마트 워치":"스마트 혈압계"}가 연동되었습니다.`})}catch(o){const y=o instanceof Error?o.message:"기기 연동에 실패했습니다.";n(h=>({...h,[s]:"idle"})),l({title:"연동 실패",description:y,variant:"destructive"})}},d=()=>{m("/onboarding/complete")};return t.jsxs(w,{className:"w-full",children:[t.jsxs(C,{children:[t.jsx(j,{children:"사용 중인 기기를 연결해요"}),t.jsx(N,{children:"자동으로 건강 데이터를 기록할 수 있어 편리해요. 나중에 언제든지 추가할 수 있어요."})]}),t.jsxs(k,{children:[t.jsx("div",{className:"grid grid-cols-2 gap-4 mb-8",children:$.map(s=>{const a=e[s.id]||"idle",r=s.icon;return t.jsxs("button",{onClick:()=>g(s.id),disabled:a!=="idle",className:b("flex flex-col items-center justify-center gap-3 p-4 border rounded-lg aspect-square text-center transition-colors","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",a==="idle"&&"hover:bg-accent",a==="connected"&&"bg-primary/10 border-primary text-primary",a==="connecting"&&"cursor-wait"),children:[a==="connecting"&&t.jsx(P,{className:"w-10 h-10 animate-spin text-primary"}),a==="connected"&&t.jsx(E,{className:"w-10 h-10 text-primary"}),a==="idle"&&t.jsx(r,{className:"w-10 h-10 text-muted-foreground"}),t.jsx("span",{className:"font-semibold text-base",children:s.name}),a==="connecting"&&t.jsx("span",{className:"text-sm text-muted-foreground",children:"연동 중..."})]},s.id)})}),t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsx(p,{size:"xl",onClick:d,className:"w-full",children:"연결 완료"}),t.jsx(p,{size:"xl",variant:"ghost",onClick:d,className:"w-full",children:"건너뛰기"})]})]})]})}export{L as default};
