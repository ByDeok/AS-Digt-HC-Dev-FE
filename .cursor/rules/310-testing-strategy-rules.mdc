# Testing Strategy Rules
Description: Defines standards for Unit, Integration, and Slice testing in Spring Boot 3.x.

## General Principles
- **Library**: JUnit 5 (Jupiter), AssertJ, Mockito.
- **Goal**: Aim for >80% line coverage on Service and Utils.
- **Naming**: `TargetClass` + `Test` (e.g., `UserServiceTest`). Method name should be descriptive (BDD style: `given_when_then`).

## Unit Testing (Fast)
- **Scope**: Domain logic, Utility classes.
- **Annotations**: `@ExtendWith(MockitoExtension.class)`.
- **Mocking**: Use `@Mock` and `@InjectMocks`. Avoid Spring Context loading (`@SpringBootTest`) for unit tests.

```java
@Test
void givenValidUser_whenRegister_thenReturnsUser() {
    // given
    // when
    // then
}
```

## Integration Testing (Reliable)
- **Scope**: Repository layer, Complex Service workflows, External integrations.
- **Containers**: Use **TestContainers** for MySQL, Redis, Kafka. Do not rely on H2 (in-memory) if prod is MySQL, to ensure dialect compatibility.
- **Annotation**: `@SpringBootTest`, `@Testcontainers`.

```java
@Container
static MySQLContainer<?> mysql = new MySQLContainer<>("mysql:9.0");
```

## Slice Testing
- **Controller**: `@WebMvcTest(UserController.class)`. Mock the Service layer.
- **Repository**: `@DataJpaTest`. Focus on query correctness and mapping.

## See also
- [300-java-spring-cursor-rules.mdc](300-java-spring-cursor-rules.mdc)
